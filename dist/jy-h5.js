!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t){this.text=t,console.log(arguments)}return t.prototype.create=function(t){return this.elem=document.createElement("div"),this.elem.className="score",this.elem.innerHTML=this.text||"",this.elem.style.position="absolute",this.elem.style.right=this.right||"10px",this.elem.style.top=this.top||"10px",this.elem},t.prototype.change=function(t){this.text=t,this.elem.innerHTML=this.text},t.prototype.remove=function(){this.elem.parentNode.removeChild(this.elem)},t}();e.default=n},function(t,e,i){"use strict";var n;e.__esModule=!0,function(t){t[t.rect=0]="rect",t[t.circle=1]="circle"}(n=e.SHAPE||(e.SHAPE={}));var s=function(){function t(t,e){this.x=0,this.y=0,this.w=0,this.h=0,this.sw=0,this.sh=0,this.sx=0,this.sy=0,this.r=0,this.shape=n.rect,this.getImg(e),this.context=t}return t.prototype.setImg=function(t){this.getImg(t)},t.prototype.getImg=function(t){this.img=new Image,this.img.src=t,this.img.onload=function(){console.log("loaded")}},t.prototype.setSize=function(t,e){this.w=t||this.w,this.h=e||this.h,this.r=this.h/2},t.prototype.getCenter=function(){return[this.x+this.r,this.y+this.r]},t.prototype.setCutSize=function(t,e){this.sw=t,this.sh=e},t.prototype.setPosition=function(t,e){this.x=t,this.y=e},t.prototype.draw=function(t){this.context.save(),t&&(this.context.translate(this.x+this.r,this.y+this.r),this.context.rotate(t),this.context.translate(-(this.x+this.r),-(this.y+this.r))),this.sw&&this.sh?this.context.drawImage(this.img,this.sx,this.sy,this.sw,this.sh,this.x,this.y,this.w,this.h):this.context.drawImage(this.img,Math.round(this.x),Math.round(this.y),this.w,this.h),this.context.restore()},t}();e.default=s},function(t,e,i){"use strict";var n=p(i(0)),s=p(i(1)),o=p(i(3)),r=p(i(4)),h=p(i(5)),l=p(i(6)),c=p(i(7)),a=p(i(8)),u=p(i(9));function p(t){return t&&t.__esModule?t:{default:t}}t.exports={Score:n.default,Sprite:s.default,Title:o.default,Descript:r.default,Stage:h.default,GameOver:l.default,Control:c.default,WriteText:a.default,JY:u.default}},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t){this.title=t,console.log(arguments)}return t.prototype.create=function(t){return this.elem=document.createElement("div"),this.elem.className="title",this.elem.style.position="absolute",this.elem.innerHTML=this.title,this.elem},t.prototype.remove=function(){this.elem.parentNode.removeChild(this.elem)},t}();e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t,e){this.btntitle=t,this.text=e,console.log(arguments)}return t.prototype.create=function(t){this.elem=document.createElement("div"),this.elem.className="discript",this.elem.innerHTML=this.text||"",this.elem.style.position="absolute";var e=document.createElement("button");return e.className="button start",e.innerText=this.btntitle,e.addEventListener("touchstart",function(e){t.call(this)}.bind(this),!1),e.addEventListener("click",function(e){t.call(this)}.bind(this),!1),this.elem.appendChild(e),this.elem},t.prototype.remove=function(){this.elem.parentNode.removeChild(this.elem)},t}();e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t,e,i){this.width=t,this.height=e,this.style=i,console.log(arguments)}return t.prototype.create=function(){return this.elem=document.createElement("canvas"),this.elem.width=this.width,this.elem.height=this.height,this.elem.style.position="absolute",this.elem},t.prototype.remove=function(){this.elem.parentNode.removeChild(this.elem)},t.prototype.bindEvent=function(t){this.elem.addEventListener("touchstart",function(e){var i=e.touches[0];t([i.pageX,i.pageY])},!1)},t}();e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t){this.btntitle=t}return t.prototype.create=function(t,e){void 0===e&&(e=""),this.elem=document.createElement("div"),this.elem.className="gameOver",this.textElem=document.createElement("div"),this.textElem.className="text",this.textElem.innerHTML=e,this.elem.appendChild(this.textElem);var i=document.createElement("button");return i.className="button",i.innerText=this.btntitle,i.addEventListener("touchstart",function(e){t.call(this)}.bind(this),!1),this.elem.appendChild(i),this.elem},t.prototype.setText=function(t){void 0===t&&(t=""),this.textElem.innerHTML=t},t.prototype.remove=function(){this.elem.parentNode.removeChild(this.elem)},t}();e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(){this.rect=[160,160],this.moveRect=[50,50],this.elemPosition=[10,10],this.angle=0}return t.prototype.create=function(){return this.elem=document.createElement("div"),this.elem.className="control",this.elem.style.position="absolute",this.elem.style.width=this.rect[0]+"px",this.elem.style.height=this.rect[1]+"px",this.elem.style.left=this.elemPosition[0]+"%",this.elem.style.bottom=this.elemPosition[1]+"%",this.moveElem=document.createElement("div"),this.moveElem.className="move",this.moveElem.style.position="absolute",this.moveElem.style.width=this.moveRect[0]+"px",this.moveElem.style.height=this.moveRect[1]+"px",this.elem.appendChild(this.moveElem),this.moveCenter=this.moveRect.map(function(t){return t/2}),this.elemCenter=this.rect.map(function(t){return t/2}),this.resetPos(),this.bindEvent(),this.elem},t.prototype.resetPos=function(){this.toPosition=[0,0],this.transPosition()},t.prototype.transPosition=function(){var t=this.elemCenter[0]-this.moveCenter[0]+this.toPosition[0],e=this.elemCenter[1]-this.moveCenter[1]-this.toPosition[1];this.moveElem.style.left=t+"px",this.moveElem.style.top=e+"px"},t.prototype.bindEvent=function(){this.elem.addEventListener("touchstart",function(t){var e=t.touches[0]||t;this.setPosition(e)}.bind(this),!1),this.elem.addEventListener("touchmove",function(t){var e=t.touches[0]||t;this.setPosition(e)}.bind(this),!1),this.elem.addEventListener("touchend",function(t){this.resetPos()}.bind(this),!1)},t.prototype.setPosition=function(t){this.position=[this.elem.offsetLeft,this.elem.offsetTop];var e=t.pageX-this.position[0],i=t.pageY-this.position[1],n=e-this.elemCenter[0],s=-(i-this.elemCenter[1]);console.log(n,s);var o=Math.atan2(s,n),r=Math.sqrt(n*n+s*s),h=this.elemCenter[0]-this.moveCenter[0];r>h&&(n=Math.cos(o)*h,s=Math.sin(o)*h);this.toPosition=[n,s],this.transPosition()},t.prototype.getAngle=function(){return this.angle=Math.atan2(this.toPosition[1],this.toPosition[0]),this.angle},t.prototype.remove=function(){this.elem.parentNode.removeChild(this.elem)},t}();e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t){this.x=0,this.y=0,this.context=t}return t.prototype.write=function(t,e,i,n,s){void 0===n&&(n=""),void 0===s&&(s=""),this.x=e,this.y=i,this.context.font=n,this.context.fillStyle=s,this.context.fillText(t,this.x,this.y)},t}();e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n,s=i(1),o=i(0);!function(t){t[t.loading=0]="loading",t[t.title=1]="title",t[t.descript=2]="descript",t[t.newGame=3]="newGame",t[t.running=4]="running",t[t.pause=5]="pause",t[t.levelUp=6]="levelUp",t[t.die=7]="die",t[t.gameOver=8]="gameOver"}(n=e.STATE||(e.STATE={}));var r=function(){function t(t,e,i,n,s,o){this.view=t,this.stage=e,this.titleStage=i,this.descriptStage=n,this.gameOverStage=s,this.controlStage=o,this.func=new Function,this.interval=10,console.log(this.view)}return t.prototype.setup=function(){this.currentState=n.loading,this.setState(n.loading),document.addEventListener("touchmove",function(t){t.preventDefault?t.preventDefault():window.event.returnValue})},t.prototype.createStage=function(){console.log(this.stage);var t=this.stage.create();this.context=t.getContext("2d"),this.view.appendChild(t)},t.prototype.run=function(){console.log("run"),this.descriptStage.remove(),this.createStage(),this.controlStage&&this.createControl(),this.setState(n.newGame)},t.prototype.scoreInit=function(){this.scoreScreen=new o.default("--"),this.view.appendChild(this.scoreScreen.create())},t.prototype.createControl=function(){this.view.appendChild(this.controlStage.create())},t.prototype.loading=function(){this.loadFile(function(){this.setState(n.title)}.bind(this))},t.prototype.loadFile=function(t){var e=this,i={};if(e.files.length>0){var n=function(n){i[n]={},i[n].count=0;var s=n;console.log(e.files[n]);for(var o=function(o,r){var h=e.files[n][o];if("image"==s){var l=new Image;l.onload=function(){i[n].count++,console.log(h+" loaded"),e.checkLoaded(i)&&t.call(e)},l.src=h}},r=0,h=e.files[n].length;r<h;r++)o(r)};for(var s in e.files)n(s)}else t.call(e)},t.prototype.checkLoaded=function(t){for(var e in t)if(t[e].count!=this.files[e].length)return!1;return!0},t.prototype.title=function(){console.log("title");var t=this.titleStage.create(function(){this.run()}.bind(this));this.view.appendChild(t),setTimeout(function(){this.titleStage.remove(),this.setState(n.descript)}.bind(this),1e3)},t.prototype.descript=function(){console.log("descript");var t=this.descriptStage.create(function(){this.run()}.bind(this));this.view.appendChild(t)},t.prototype.newGame=function(){this.scoreInit(),this.setState(n.running),this.startTimer()},t.prototype.over=function(){this.setState(n.gameOver)},t.prototype.pause=function(){this.stopTimer()},t.prototype.play=function(){this.startTimer()},t.prototype.gameOver=function(){console.log("gameOver"),this.scoreScreen.remove(),this.stage.remove(),this.controlStage&&this.controlStage.remove(),this.stopTimer();var t=this.gameOverStage.create(function(){this.gameOverStage.remove(),this.setState(n.descript)}.bind(this));this.view.appendChild(t)},t.prototype.stopTimer=function(){clearInterval(this.timer)},t.prototype.startTimer=function(){var t=this;this.timer=setInterval(function(){t.func.bind(t)()},this.interval)},t.prototype.running=function(){this.context.clearRect(0,0,this.stage.width,this.stage.height)},t.prototype.checkState=function(){switch(this.currentState){case n.loading:this.func=this.loading;break;case n.title:this.func=this.title;break;case n.descript:this.func=this.descript;break;case n.newGame:this.func=this.newGame;break;case n.running:this.func=this.running;break;case n.gameOver:this.func=this.gameOver}},t.prototype.setState=function(t){this.currentState=t,this.checkState(),this.func()},t.prototype.hits=function(t,e){var i=!1,n=!1;if(t.shape==s.SHAPE.rect){var o=e.w,r=t.w,h=e.h,l=t.h;return i=t.x>e.x?t.x-e.x<o:!(t.x<e.x)||e.x-t.x<r,n=t.y>e.y?t.y-e.y<h:!(t.y<e.y)||e.y-t.y<l,i&&n}if(t.shape==s.SHAPE.circle){var c=t.r+e.r,a=t.getCenter(),u=e.getCenter();return i=Math.abs(a[0]-u[0])<c,n=Math.abs(a[1]-u[1])<c,i&&n}},t}();e.default=r}])});