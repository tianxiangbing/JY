var STATE;!function(t){t[t.loading=0]="loading",t[t.title=1]="title",t[t.descript=2]="descript",t[t.newGame=3]="newGame",t[t.running=4]="running",t[t.pause=5]="pause",t[t.levelUp=6]="levelUp",t[t.die=7]="die",t[t.gameOver=8]="gameOver"}(STATE||(STATE={}));var JY=function(){function t(t,e,i,n,o,r){this.view=t,this.stage=e,this.titleStage=i,this.descriptStage=n,this.gameOverStage=o,this.controlStage=r,this.func=new Function,this.interval=10,console.log(this.view)}return t.prototype.setup=function(){this.currentState=STATE.loading,this.setState(STATE.loading),document.addEventListener("touchmove",function(t){t.preventDefault?t.preventDefault():0==window.event.returnValue})},t.prototype.createStage=function(){console.log(this.stage);var t=this.stage.create();this.context=t.getContext("2d"),this.view.appendChild(t)},t.prototype.run=function(){console.log("run"),this.descriptStage.remove(),this.createStage(),this.controlStage&&this.createControl(),this.setState(STATE.newGame)},t.prototype.scoreInit=function(){this.scoreScreen=new Score("--"),this.view.appendChild(this.scoreScreen.create())},t.prototype.createControl=function(){this.view.appendChild(this.controlStage.create())},t.prototype.loading=function(){this.loadFile(function(){this.setState(STATE.title)}.bind(this))},t.prototype.loadFile=function(t){var e=this,i={};if(e.files.length>0){var n=function(n){i[n]={},i[n].count=0;var o=n;console.log(e.files[n]);for(var r=function(r,s){var a=e.files[n][r];if("image"==o){var c=new Image;c.onload=function(){i[n].count++,console.log(a+" loaded"),e.checkLoaded(i)&&t.call(e)},c.src=a}},s=0,a=e.files[n].length;s<a;s++)r(s,a)};for(var o in e.files)n(o)}else t.call(e)},t.prototype.checkLoaded=function(t){for(var e in t)if(t[e].count!=this.files[e].length)return!1;return!0},t.prototype.title=function(){console.log("title");var t=this.titleStage.create(function(){this.run()}.bind(this));this.view.appendChild(t),setTimeout(function(){this.titleStage.remove(),this.setState(STATE.descript)}.bind(this),1e3)},t.prototype.descript=function(){console.log("descript");var t=this.descriptStage.create(function(){this.run()}.bind(this));this.view.appendChild(t)},t.prototype.newGame=function(){this.scoreInit(),this.setState(STATE.running),this.startTimer()},t.prototype.over=function(){this.setState(STATE.gameOver)},t.prototype.pause=function(){this.stopTimer()},t.prototype.play=function(){this.startTimer()},t.prototype.gameOver=function(){console.log("gameOver"),this.scoreScreen.remove(),this.stage.remove(),this.controlStage&&this.controlStage.remove(),this.stopTimer();var t=this.gameOverStage.create(function(){this.gameOverStage.remove(),this.setState(STATE.descript)}.bind(this));this.view.appendChild(t)},t.prototype.stopTimer=function(){clearInterval(this.timer)},t.prototype.startTimer=function(){var t=this;this.timer=setInterval(function(){t.func.bind(t)()},this.interval)},t.prototype.running=function(){this.context.clearRect(0,0,this.stage.width,this.stage.height)},t.prototype.checkState=function(){switch(this.currentState){case STATE.loading:this.func=this.loading;break;case STATE.title:this.func=this.title;break;case STATE.descript:this.func=this.descript;break;case STATE.newGame:this.func=this.newGame;break;case STATE.running:this.func=this.running;break;case STATE.gameOver:this.func=this.gameOver}},t.prototype.setState=function(t){this.currentState=t,this.checkState(),this.func()},t.prototype.hits=function(t,e){var i=!1,n=!1;if(t.shape==SHAPE.rect){var o=e.w,r=t.w,s=e.h,a=t.h;return i=t.x>e.x?t.x-e.x<o:!(t.x<e.x)||e.x-t.x<r,n=t.y>e.y?t.y-e.y<s:!(t.y<e.y)||e.y-t.y<a,i&&n}if(t.shape==SHAPE.circle){var c=t.r+e.r,h=t.getCenter(),l=e.getCenter();return i=Math.abs(h[0]-l[0])<c,n=Math.abs(h[1]-l[1])<c,i&&n}},t}();
//# sourceMappingURL=index.js.map
